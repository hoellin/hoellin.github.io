
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm {% if site.navbar_fixed %}fixed-top{% else %}sticky-top{% endif %}">
        <div class="container">
          {%- comment -%} Resolve Photography hub link early {%- endcomment -%}
          {%- assign photo_link = nil -%}
          {%- if site.navbar_links -%}
            {%- for link in site.navbar_links -%}
              {%- if link.url == '/photography/' -%}
                {%- assign photo_link = link -%}
              {%- endif -%}
            {%- endfor -%}
          {%- endif -%}

          {% if page.permalink != '/' -%}
          <a class="navbar-brand title font-weight-lighter {% if photo_link %}d-none d-sm-none{% endif %}" href="{{ site.baseurl }}/">
            {%- if site.title == "blank" -%}
              {%- if site.first_name -%}
                <span class="font-weight-bold">{{- site.first_name -}}&nbsp;</span>
              {%- endif -%}
              {%- if site.middle_name -%}
                {{- site.middle_name -}}&nbsp;
              {%- endif -%}
              {%- if site.last_name -%}
                {{- site.last_name -}}
              {%- endif -%}
            {%- else -%}
              {{- site.title -}}
            {%- endif -%}
          </a>
          {%- elsif site.enable_navbar_social -%}
          <!-- Social Icons -->
          <div class="navbar-brand social">
            {% include social.html %}
          </div>
          {% endif %}

          {%- comment -%}
          Left-aligned Photography CTA, separated from other nav items.
          {%- endcomment -%}
          {%- if photo_link -%}
          <a class="nav-link nav-link--prints ml-3 d-none d-sm-inline-block" href="{{ photo_link.url | relative_url }}" data-i18n="nav.photography" data-i18n-attr="aria-label" aria-label="Photography">Photography</a>
          {%- endif -%}
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              {%- for page in site.pages -%}
                {% if page.permalink == '/' %}
                  {% assign about_title = page.title %}
                {% endif %}
              {% endfor %}

              <!-- About -->
              <li class="nav-item {% if page.permalink == '/' %}active{% endif %}">
                <a class="nav-link" href="{{ '/' | relative_url }}"><span data-i18n="nav.about">{{ about_title }}</span>
                  {%- if page.permalink == '/' -%}
                  <span class="sr-only">(current)</span>
                  {%- endif -%}
                </a>
              </li>
              {% if site.blog_nav_title %}
              <!-- Blog -->
              <li class="nav-item {% if page.url contains 'blog' %}active{% endif %}">
                <a class="nav-link" href="{{ '/blog/' | relative_url }}"><span data-i18n="nav.blog">{{ site.blog_nav_title }}</span>
                  {%- if page.url contains 'blog' -%}
                  <span class="sr-only">(current)</span>
                  {%- endif -%}
              </a>
              </li>
              {%- endif %}

              {%- if photo_link -%}
              <!-- Mobile: show Photography link inside the collapsed menu (highlighted) -->
              <li class="nav-item d-sm-none {% if page.url == photo_link.url or page.permalink == photo_link.url %}active{% endif %}">
                <a class="nav-link nav-link--prints" href="{{ photo_link.url | relative_url }}"><span data-i18n="nav.photography">Photography</span>
                  {%- if page.url == photo_link.url or page.permalink == photo_link.url -%}
                  <span class="sr-only">(current)</span>
                  {%- endif -%}
                </a>
              </li>
              {%- endif -%}

              {%- if site.navbar_links -%}
              <!-- Custom links from _config.yml: navbar_links -->
              {%- for link in site.navbar_links -%}
              {%- if link.url == '/photography/' -%}{%- continue -%}{%- endif -%}
              <li class="nav-item {% if page.url == link.url or page.permalink == link.url %}active{% endif %}">
                <a class="nav-link" href="{{ link.url | relative_url }}">{{ link.title }}
                  {%- if page.url == link.url or page.permalink == link.url -%}
                  <span class="sr-only">(current)</span>
                  {%- endif -%}
                </a>
              </li>
              {%- endfor -%}
              {%- endif -%}

              <!-- Other pages -->
              {%- assign sorted_pages = site.pages | sort: "nav_order" -%}
              {%- assign custom_urls = '' -%}
              {%- if site.navbar_links -%}
                {%- for link in site.navbar_links -%}
                  {%- assign custom_urls = custom_urls | append: '|' | append: link.url -%}
                {%- endfor -%}
                {%- assign custom_urls = custom_urls | append: '|' -%}
              {%- endif -%}
              {%- for p in sorted_pages -%}
              {%- if p.nav and p.autogen == nil -%}
              {%- assign page_url_token = '|' | append: p.url | append: '|' -%}
              {%- if custom_urls and (custom_urls contains page_url_token) -%}
              {%- continue -%}
              {%- endif -%}
              {%- if p.dropdown %}
              <li class="nav-item dropdown {% if page.title == p.title %}active{% endif %}">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ p.title }}
                  {%- if page.title == p.title -%}
                  <span class="sr-only">(current)</span>
                  {%- endif -%}
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  {%- for child in p.children -%}
                  {%- if child.title == 'divider' %}
                  <div class="dropdown-divider"></div>
                  {%- else %}
                  <a class="dropdown-item" href="{{ child.permalink | relative_url }}">{{ child.title }}</a>
                  {%- endif -%}
                  {% endfor %}
                </div>
              </li>
              {%- else %}
              <li class="nav-item {% if page.title == p.title %}active{% endif %}">
                <a class="nav-link" href="{{ p.url | relative_url }}"><span data-i18n="nav.{{ p.title | downcase | replace:' ','_' }}">{{ p.title }}</span>
                  {%- if page.title == p.title -%}
                  <span class="sr-only">(current)</span>
                  {%- endif -%}
                </a>
              </li>
              {%- endif -%}
              {%- endif -%}
              {% endfor -%}
              <!-- Language toggle (fixed width) -->
              <li class="nav-item">
                <a class="nav-link nav-lang-toggle" href="#" data-set-lang aria-label="Switch language">FR</a>
              </li>
              {%- if site.enable_darkmode %}

              <!-- Toggle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
              {%- endif %}
            </ul>
          </div>
        </div>
      </nav>
    </header>
